# PR Quality Assessment Workflow - Architecture Diagram

## Workflow Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         GitHub Actions Trigger                       â”‚
â”‚  â€¢ PR opened/updated/reopened (automatic)                           â”‚
â”‚  â€¢ Manual workflow dispatch (for comparison)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Environment Setup                                 â”‚
â”‚  â€¢ Checkout repository (full history)                               â”‚
â”‚  â€¢ Setup Python 3.11                                                â”‚
â”‚  â€¢ Install tools: lizard, radon, pygments, jinja2, GitPython       â”‚
â”‚  â€¢ Install SwiftLint                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    analyze_pr.py (724 lines)                        â”‚
â”‚                                                                      â”‚
â”‚  Input: --pr-number, --base-ref, --head-ref                        â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ 1. Get Changed Files (git diff)                          â”‚     â”‚
â”‚  â”‚    â€¢ File paths, lines added/deleted                     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                             â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ 2. Cyclomatic Complexity (lizard)                        â”‚     â”‚
â”‚  â”‚    â€¢ Per-function CC analysis                            â”‚     â”‚
â”‚  â”‚    â€¢ Complexity distribution                             â”‚     â”‚
â”‚  â”‚    â€¢ High complexity identification (CC > 10)            â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                             â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ 3. Code Quality Analysis                                 â”‚     â”‚
â”‚  â”‚    â€¢ Line counting (code/comment/blank)                  â”‚     â”‚
â”‚  â”‚    â€¢ Risk pattern detection                              â”‚     â”‚
â”‚  â”‚    â€¢ Swift pattern analysis (good/bad)                   â”‚     â”‚
â”‚  â”‚    â€¢ Component identification                            â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                             â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ 4. Architecture Quality                                  â”‚     â”‚
â”‚  â”‚    â€¢ SOLID principles check                              â”‚     â”‚
â”‚  â”‚    â€¢ Layer separation                                    â”‚     â”‚
â”‚  â”‚    â€¢ Dependency patterns                                 â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                             â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ 5. Test Coverage Analysis                                â”‚     â”‚
â”‚  â”‚    â€¢ Test-to-code ratio                                  â”‚     â”‚
â”‚  â”‚    â€¢ Untested components                                 â”‚     â”‚
â”‚  â”‚    â€¢ Coverage score                                      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                             â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ 6. Code Duplication Detection                            â”‚     â”‚
â”‚  â”‚    â€¢ Hash-based algorithm                                â”‚     â”‚
â”‚  â”‚    â€¢ Duplication score                                   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                             â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ 7. SoundScape-Specific Analysis                          â”‚     â”‚
â”‚  â”‚    â€¢ Component identification                            â”‚     â”‚
â”‚  â”‚    â€¢ Audio/recording changes                             â”‚     â”‚
â”‚  â”‚    â€¢ UI/paywall changes                                  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                             â”‚                                        â”‚
â”‚  Output: pr-{number}-analysis.json                                 â”‚
â”‚  {                                                                  â”‚
â”‚    "pr_number": "123",                                              â”‚
â”‚    "metrics": {                                                     â”‚
â”‚      "basic": {...},                                                â”‚
â”‚      "complexity": {...},                                           â”‚
â”‚      "architecture": {...},                                         â”‚
â”‚      "testing": {...},                                              â”‚
â”‚      "patterns": {...},                                             â”‚
â”‚      "quality_score": {...}                                         â”‚
â”‚    }                                                                â”‚
â”‚  }                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Comparison      â”‚
                    â”‚ Requested?      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ YES                     â”‚ NO
                â–¼                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   compare_prs.py (457 lines) â”‚        â”‚
â”‚                               â”‚        â”‚
â”‚  1. Load all PR analyses     â”‚        â”‚
â”‚  2. Compare metrics          â”‚        â”‚
â”‚  3. Rank PRs by quality      â”‚        â”‚
â”‚  4. Generate recommendations â”‚        â”‚
â”‚  5. Detailed breakdown       â”‚        â”‚
â”‚                               â”‚        â”‚
â”‚  Output: pr-comparison.json  â”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
                â”‚                         â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  generate_report.py (710 lines)                     â”‚
â”‚                                                                      â”‚
â”‚  1. Load analysis JSON                                              â”‚
â”‚  2. Load comparison JSON (if exists)                                â”‚
â”‚  3. Generate markdown sections:                                     â”‚
â”‚     â€¢ Summary with grade and score                                  â”‚
â”‚     â€¢ Detailed metrics with tables                                  â”‚
â”‚     â€¢ File-by-file analysis                                         â”‚
â”‚     â€¢ SoundScape-specific insights                                  â”‚
â”‚     â€¢ Comparison tables (if comparing)                              â”‚
â”‚     â€¢ Recommendations                                               â”‚
â”‚     â€¢ Production readiness                                          â”‚
â”‚                                                                      â”‚
â”‚  Output: pr-quality-report.md                                       â”‚
â”‚                                                                      â”‚
â”‚  Example:                                                           â”‚
â”‚  # ğŸ“Š PR Quality Assessment Report                                 â”‚
â”‚  ## ğŸŒŸ Grade A - 92.50/100                                         â”‚
â”‚  ...                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            check_quality_thresholds.py (275 lines)                  â”‚
â”‚                                                                      â”‚
â”‚  1. Load analysis JSON                                              â”‚
â”‚  2. Check against thresholds:                                       â”‚
â”‚     â€¢ Overall score â‰¥ 60                                            â”‚
â”‚     â€¢ Test coverage â‰¥ 50                                            â”‚
â”‚     â€¢ Avg complexity â‰¤ 15                                           â”‚
â”‚     â€¢ Architecture score â‰¥ 60                                       â”‚
â”‚     â€¢ High-risk files â‰¤ 10                                          â”‚
â”‚  3. Generate warnings/errors                                        â”‚
â”‚  4. Create GitHub Actions annotations                               â”‚
â”‚                                                                      â”‚
â”‚  Exit: 0 (pass) or 1 (fail)                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                         â”‚
                â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Upload Artifacts      â”‚  â”‚  Post PR Comment        â”‚
â”‚                         â”‚  â”‚                         â”‚
â”‚  â€¢ analysis.json        â”‚  â”‚  # ğŸ“Š PR Quality...     â”‚
â”‚  â€¢ comparison.json      â”‚  â”‚  ## Grade A - 92.50     â”‚
â”‚  â€¢ report.md            â”‚  â”‚  ...                    â”‚
â”‚                         â”‚  â”‚                         â”‚
â”‚  Retained: 90 days      â”‚  â”‚  (Updates existing)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GitHub Repository                          â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   Source Code      â”‚        â”‚   Test Code         â”‚       â”‚
â”‚  â”‚   (Swift files)    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”¤   (XCTest)          â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚           â”‚                              â”‚                    â”‚
â”‚           â”‚                              â”‚                    â”‚
â”‚           â–¼                              â–¼                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚           Git Diff (base â†” head)                  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   Analysis Tools               â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ â€¢ lizard (complexity)          â”‚
            â”‚ â€¢ radon (metrics)              â”‚
            â”‚ â€¢ SwiftLint (style)            â”‚
            â”‚ â€¢ Custom algorithms            â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   Analysis Results             â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ â€¢ Complexity metrics           â”‚
            â”‚ â€¢ Architecture scores          â”‚
            â”‚ â€¢ Test coverage data           â”‚
            â”‚ â€¢ Risk assessments             â”‚
            â”‚ â€¢ Pattern detections           â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   Quality Scoring              â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ Overall = (                    â”‚
            â”‚   complexity +                 â”‚
            â”‚   architecture +               â”‚
            â”‚   testing +                    â”‚
            â”‚   reusability                  â”‚
            â”‚ ) / 4                          â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   Reports & Artifacts          â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ â€¢ Markdown report              â”‚
            â”‚ â€¢ JSON analysis data           â”‚
            â”‚ â€¢ PR comment                   â”‚
            â”‚ â€¢ GitHub annotations           â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Structures

### Analysis JSON Structure
```json
{
  "pr_number": "123",
  "base_ref": "main",
  "head_ref": "feature-branch",
  "metrics": {
    "basic": {
      "files_changed": 12,
      "lines_added": 450,
      "lines_deleted": 120,
      "total_changes": 570,
      "net_lines": 330
    },
    "complexity": {
      "total_functions": 18,
      "avg_complexity": 3.5,
      "max_complexity": 8,
      "high_complexity_functions": [],
      "complexity_distribution": {
        "low": 15,
        "medium": 3,
        "high": 0
      }
    },
    "architecture": {
      "architecture_score": 90,
      "solid_principles": {
        "score": 90,
        "violations": []
      },
      "separation_of_concerns": {
        "score": 90,
        "details": {...}
      }
    },
    "testing": {
      "code_files_changed": 10,
      "test_files_changed": 8,
      "test_to_code_ratio": 0.89,
      "coverage_score": 90,
      "test_quality": "excellent"
    },
    "patterns": {
      "reusability": {
        "duplication_score": 95.0,
        "duplicate_lines": 22
      }
    },
    "quality_score": {
      "overall": 92.5,
      "grade": "A",
      "breakdown": {
        "complexity": 95.0,
        "architecture": 90.0,
        "testing": 90.0,
        "reusability": 95.0
      }
    },
    "files": {
      "path/to/file.swift": {
        "added": 45,
        "deleted": 12,
        "risk_level": "medium",
        "risk_factors": [...],
        "component": "AudioEngine",
        "patterns": {...}
      }
    }
  }
}
```

### Comparison JSON Structure
```json
{
  "prs": ["123", "124"],
  "metrics_comparison": {
    "basic": {...},
    "complexity": {...},
    "architecture": {...},
    "testing": {...}
  },
  "quality_ranking": [
    {
      "pr_number": "123",
      "rank": 1,
      "overall_score": 92.5,
      "quality_per_line": 0.1623,
      "grade": "A"
    },
    {
      "pr_number": "124",
      "rank": 2,
      "overall_score": 72.0,
      "quality_per_line": 0.0562,
      "grade": "C"
    }
  ],
  "recommendations": {
    "best_pr": "123",
    "reasons_best_is_better": [...],
    "improvements_for_others": [...]
  }
}
```

## Execution Timeline

```
Time    Action
â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
0:00    PR opened/updated â†’ Workflow triggered
0:05    Environment setup (Python, tools)
0:10    SwiftLint installation
0:15    analyze_pr.py starts
0:20    â”œâ”€ Git diff analysis
0:25    â”œâ”€ Complexity analysis (lizard)
0:35    â”œâ”€ Code quality analysis
0:45    â”œâ”€ Architecture analysis
0:50    â”œâ”€ Test coverage analysis
0:55    â”œâ”€ Duplication detection
1:00    â””â”€ SoundScape-specific analysis
1:05    Analysis JSON saved
1:10    compare_prs.py (if requested)
1:20    generate_report.py starts
1:30    Report markdown generated
1:35    check_quality_thresholds.py
1:40    Artifacts uploaded
1:45    PR comment posted
1:50    âœ… Workflow complete
```

## Integration Points

```
GitHub
  â”œâ”€ Pull Request Events
  â”‚   â”œâ”€ opened
  â”‚   â”œâ”€ synchronize
  â”‚   â””â”€ reopened
  â”‚
  â”œâ”€ Workflow Dispatch (manual)
  â”‚   â””â”€ Input: compare_pr_numbers
  â”‚
  â”œâ”€ Actions Runner
  â”‚   â”œâ”€ ubuntu-latest
  â”‚   â”œâ”€ Python 3.11
  â”‚   â””â”€ Analysis tools
  â”‚
  â””â”€ Outputs
      â”œâ”€ PR Comments
      â”œâ”€ Artifacts
      â””â”€ Annotations
```

## Summary

- **Total Lines of Code**: 2,265+
- **Analysis Scripts**: 4 (724 + 457 + 710 + 275 lines)
- **Documentation**: 4 files (1,136 lines)
- **Test Suite**: 322 lines (5/5 tests passing)
- **Workflow Time**: ~2-5 minutes
- **Artifact Retention**: 90 days
- **Quality Thresholds**: Configurable
- **Production Ready**: âœ… Yes
